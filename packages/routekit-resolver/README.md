[RouteKit](https://github.com/localvoid/routekit) is a set of tools for generating lightweight and efficient routers.

## Installation

```sh
$ npm install -D routekit
```

## Usage Example

Create a routes file: `routes.build.js`

```js
#!/usr/bin/env node

const routekit = require("routekit");
const emitRoutes = require("routekit-js").emitRoutes;

const routes = new routekit.Builder();

function r(name, path, data) {
  routes.add(name, path, routekit.HttpMethod.GET, JSON.stringify(data));
}

r("userView", "/user/:id", "user/view");
r("userEdit", "/user/:id/edit", "user/edit");
r("home", "/", "home");

process.stdout.write(emitRoutes(routes));
```

Run `routes.build.js` file

```sh
$ node routes.build.js
```

And it will generate `routes.js` file with a compact flattened radix trie.

```js
export const ROUTES = {
  f: [43, 50, 41, 27],
  p: ["user/", "/edit"],
  d: ["home", "user/view", "user/edit"],
};
```

## Tools

### Builder

Builder provides an easy interface for building routes. It will perform all necessary transformations and generate a
radix tree.

```ts
export class RouteBuilder<T> implements Routes {
  add(name: string, path: string, method: HttpMethod, data?: T): void;
  setData(path: string, method: HttpMethod, data?: T): void;
}
```

It is possible that in the future there will be builders with different interfaces for building routes.

### Routes

Routes object contains details about registered routes as a radix tree and reverse mapping from route names to urls.

```ts
interface Routes {
  root: Node<any>;
  reverse: Map<string, string[]>;
}
```

### Emmiter

Emitter generates programming code from `Routes` object.

#### Javascript Emitter

Javascript emitter generates flattened radix tries in "browser" mode and fast radix tries in "server" mode. It also
supports emitting types for TypeScript.

```ts
interface JSEmitterOptions {
  target?: "es2015" | "ts";
  mode?: "browser" | "server";
}

function emitRoutes(routes: Routes, name: string = "ROUTES", options?: JSEmitOptions): string;
function emitReverseFunctions(routes: Routes, options?: JSEmitOptions): string;
function emitReverseMap(routes: Routes, name: string = "REVERSE", options?: JSEmitOptions): string;

function inject(routes: Routes, src: string, options?: JSEmitOptions): string;
```

`inject` function injects code blocks into existing code using [incode](https://github.com/localvoid/incode) package.
This function is using `routekit` prefix to detect injectable regions.

### Resolver

Resolver is a function that uses generated tree to find a match for an url.

Available resolvers:

- `routekit-resolver` is a basic resolver for browser environments that works with flattened trees generated by
 javascript emitter.
